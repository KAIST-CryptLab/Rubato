#ifndef __PARMS_H__
#define __PARMS_H__

#include <stdint.h>

#define PARAM_80_S 0
#define PARAM_80_M 1
#define PARAM_80_L 2
#define PARAM_128_S 3
#define PARAM_128_M 4
#define PARAM_128_L 5

#define XOF_AES 0
#define XOF_SHAKE128 1
#define XOF_SHAKE256 2

#ifndef PARAM_ID
    #define PARAM_ID PARAM_80_L
#endif
#ifndef XOF_TYPE
    #define XOF_TYPE XOF_AES
#endif

alignas(32) static const uint32_t CDF_TABLE_80_S[29*8] = {
    193466994, 193466994, 193466994, 193466994, 193466994, 193466994, 193466994, 193466994,
    570659710, 570659710, 570659710, 570659710, 570659710, 570659710, 570659710, 570659710,
    920075514, 920075514, 920075514, 920075514, 920075514, 920075514, 920075514, 920075514,
    1227667221, 1227667221, 1227667221, 1227667221, 1227667221, 1227667221, 1227667221, 1227667221,
    1484978918, 1484978918, 1484978918, 1484978918, 1484978918, 1484978918, 1484978918, 1484978918,
    1689527875, 1689527875, 1689527875, 1689527875, 1689527875, 1689527875, 1689527875, 1689527875,
    1844048991, 1844048991, 1844048991, 1844048991, 1844048991, 1844048991, 1844048991, 1844048991,
    1954974452, 1954974452, 1954974452, 1954974452, 1954974452, 1954974452, 1954974452, 1954974452,
    2030645103, 2030645103, 2030645103, 2030645103, 2030645103, 2030645103, 2030645103, 2030645103,
    2079699341, 2079699341, 2079699341, 2079699341, 2079699341, 2079699341, 2079699341, 2079699341,
    2109918225, 2109918225, 2109918225, 2109918225, 2109918225, 2109918225, 2109918225, 2109918225,
    2127608442, 2127608442, 2127608442, 2127608442, 2127608442, 2127608442, 2127608442, 2127608442,
    2137449475, 2137449475, 2137449475, 2137449475, 2137449475, 2137449475, 2137449475, 2137449475,
    2142651843, 2142651843, 2142651843, 2142651843, 2142651843, 2142651843, 2142651843, 2142651843,
    2145265294, 2145265294, 2145265294, 2145265294, 2145265294, 2145265294, 2145265294, 2145265294,
    2146512908, 2146512908, 2146512908, 2146512908, 2146512908, 2146512908, 2146512908, 2146512908,
    2147078886, 2147078886, 2147078886, 2147078886, 2147078886, 2147078886, 2147078886, 2147078886,
    2147322875, 2147322875, 2147322875, 2147322875, 2147322875, 2147322875, 2147322875, 2147322875,
    2147422828, 2147422828, 2147422828, 2147422828, 2147422828, 2147422828, 2147422828, 2147422828,
    2147461739, 2147461739, 2147461739, 2147461739, 2147461739, 2147461739, 2147461739, 2147461739,
    2147476134, 2147476134, 2147476134, 2147476134, 2147476134, 2147476134, 2147476134, 2147476134,
    2147481194, 2147481194, 2147481194, 2147481194, 2147481194, 2147481194, 2147481194, 2147481194,
    2147482885, 2147482885, 2147482885, 2147482885, 2147482885, 2147482885, 2147482885, 2147482885,
    2147483421, 2147483421, 2147483421, 2147483421, 2147483421, 2147483421, 2147483421, 2147483421,
    2147483583, 2147483583, 2147483583, 2147483583, 2147483583, 2147483583, 2147483583, 2147483583,
    2147483630, 2147483630, 2147483630, 2147483630, 2147483630, 2147483630, 2147483630, 2147483630,
    2147483642, 2147483642, 2147483642, 2147483642, 2147483642, 2147483642, 2147483642, 2147483642,
    2147483646, 2147483646, 2147483646, 2147483646, 2147483646, 2147483646, 2147483646, 2147483646,
    2147483647, 2147483647, 2147483647, 2147483647, 2147483647, 2147483647, 2147483647, 2147483647
};

static const uint32_t CDF_TABLE_80_M[8*8] = {
    795364312, 795364312, 795364312, 795364312, 795364312, 795364312, 795364312, 795364312,
    1829169833, 1829169833, 1829169833, 1829169833, 1829169833, 1829169833, 1829169833, 1829169833,
    2112940235, 2112940235, 2112940235, 2112940235, 2112940235, 2112940235, 2112940235, 2112940235,
    2145839095, 2145839095, 2145839095, 2145839095, 2145839095, 2145839095, 2145839095, 2145839095,
    2147450037, 2147450037, 2147450037, 2147450037, 2147450037, 2147450037, 2147450037, 2147450037,
    2147483354, 2147483354, 2147483354, 2147483354, 2147483354, 2147483354, 2147483354, 2147483354,
    2147483645, 2147483645, 2147483645, 2147483645, 2147483645, 2147483645, 2147483645, 2147483645,
    2147483647, 2147483647, 2147483647, 2147483647, 2147483647, 2147483647, 2147483647, 2147483647
};

static const uint32_t CDF_TABLE_80_L[5*8] = {
    1341314782, 1341314782, 1341314782, 1341314782, 1341314782, 1341314782, 1341314782, 1341314782,
    2127638171, 2127638171, 2127638171, 2127638171, 2127638171, 2127638171, 2127638171, 2127638171,
    2147440791, 2147440791, 2147440791, 2147440791, 2147440791, 2147440791, 2147440791, 2147440791,
    2147483639, 2147483639, 2147483639, 2147483639, 2147483639, 2147483639, 2147483639, 2147483639,
    2147483647, 2147483647, 2147483647, 2147483647, 2147483647, 2147483647, 2147483647, 2147483647
};

static const uint32_t CDF_TABLE_128_S[28*8] = {
    204522251, 204522251, 204522251, 204522251, 204522251, 204522251, 204522251, 204522251,
    602075463, 602075463, 602075463, 602075463, 602075463, 602075463, 602075463, 602075463,
    967055725, 967055725, 967055725, 967055725, 967055725, 967055725, 967055725, 967055725,
    1283569708, 1283569708, 1283569708, 1283569708, 1283569708, 1283569708, 1283569708, 1283569708,
    1542847805, 1542847805, 1542847805, 1542847805, 1542847805, 1542847805, 1542847805, 1542847805,
    1743474246, 1743474246, 1743474246, 1743474246, 1743474246, 1743474246, 1743474246, 1743474246,
    1890116766, 1890116766, 1890116766, 1890116766, 1890116766, 1890116766, 1890116766, 1890116766,
    1991363511, 1991363511, 1991363511, 1991363511, 1991363511, 1991363511, 1991363511, 1991363511,
    2057395083, 2057395083, 2057395083, 2057395083, 2057395083, 2057395083, 2057395083, 2057395083,
    2098074209, 2098074209, 2098074209, 2098074209, 2098074209, 2098074209, 2098074209, 2098074209,
    2121746538, 2121746538, 2121746538, 2121746538, 2121746538, 2121746538, 2121746538, 2121746538,
    2134759009, 2134759009, 2134759009, 2134759009, 2134759009, 2134759009, 2134759009, 2134759009,
    2141515606, 2141515606, 2141515606, 2141515606, 2141515606, 2141515606, 2141515606, 2141515606,
    2144829553, 2144829553, 2144829553, 2144829553, 2144829553, 2144829553, 2144829553, 2144829553,
    2146364921, 2146364921, 2146364921, 2146364921, 2146364921, 2146364921, 2146364921, 2146364921,
    2147036859, 2147036859, 2147036859, 2147036859, 2147036859, 2147036859, 2147036859, 2147036859,
    2147314635, 2147314635, 2147314635, 2147314635, 2147314635, 2147314635, 2147314635, 2147314635,
    2147423105, 2147423105, 2147423105, 2147423105, 2147423105, 2147423105, 2147423105, 2147423105,
    2147463116, 2147463116, 2147463116, 2147463116, 2147463116, 2147463116, 2147463116, 2147463116,
    2147477056, 2147477056, 2147477056, 2147477056, 2147477056, 2147477056, 2147477056, 2147477056,
    2147481645, 2147481645, 2147481645, 2147481645, 2147481645, 2147481645, 2147481645, 2147481645,
    2147483071, 2147483071, 2147483071, 2147483071, 2147483071, 2147483071, 2147483071, 2147483071,
    2147483490, 2147483490, 2147483490, 2147483490, 2147483490, 2147483490, 2147483490, 2147483490,
    2147483606, 2147483606, 2147483606, 2147483606, 2147483606, 2147483606, 2147483606, 2147483606,
    2147483637, 2147483637, 2147483637, 2147483637, 2147483637, 2147483637, 2147483637, 2147483637,
    2147483644, 2147483644, 2147483644, 2147483644, 2147483644, 2147483644, 2147483644, 2147483644,
    2147483646, 2147483646, 2147483646, 2147483646, 2147483646, 2147483646, 2147483646, 2147483646,
    2147483647, 2147483647, 2147483647, 2147483647, 2147483647, 2147483647, 2147483647, 2147483647
};

static const uint32_t CDF_TABLE_128_ML[11*8] = {
    523776498, 523776498, 523776498, 523776498, 523776498, 523776498, 523776498, 523776498,
    1392759815, 1392759815, 1392759815, 1392759815, 1392759815, 1392759815, 1392759815, 1392759815,
    1888801005, 1888801005, 1888801005, 1888801005, 1888801005, 1888801005, 1888801005, 1888801005,
    2083648537, 2083648537, 2083648537, 2083648537, 2083648537, 2083648537, 2083648537, 2083648537,
    2147483647, 2147483647, 2147483647, 2147483647, 2147483647, 2147483647, 2147483647, 2147483647,
    2146112362, 2146112362, 2146112362, 2146112362, 2146112362, 2146112362, 2146112362, 2146112362,
    2147366230, 2147366230, 2147366230, 2147366230, 2147366230, 2147366230, 2147366230, 2147366230,
    2147476666, 2147476666, 2147476666, 2147476666, 2147476666, 2147476666, 2147476666, 2147476666,
    2147483359, 2147483359, 2147483359, 2147483359, 2147483359, 2147483359, 2147483359, 2147483359,
    2147483638, 2147483638, 2147483638, 2147483638, 2147483638, 2147483638, 2147483638, 2147483638,
    2147483647, 2147483647, 2147483647, 2147483647, 2147483647, 2147483647, 2147483647, 2147483647
};

#if PARAM_ID == PARAM_80_S
    #define BLOCKSIZE 16
    #define OUTPUTSIZE 12
    #define ROUNDS 2
    #define Q 0x3ee0001ULL
    #define Q_BIT_MASK 0x3ffffffULL
    #define XOF_ELEMENT_COUNT ((ROUNDS + 1) * BLOCKSIZE)

    #define R 0x100000000ULL
    #define R2_MOD_Q 0x2b2e03bULL
    #define Qbar_MOD_R 0x3edffffULL
    #define RINV_MOD_Q 0xf7144ULL

    #define CDF_TABLE_LEN 29
    #define CDF_TABLE CDF_TABLE_80_S
#elif PARAM_ID == PARAM_80_M
    #define BLOCKSIZE 36
    #define OUTPUTSIZE 32
    #define ROUNDS 2
    #define Q 0x1fc0001ULL
    #define Q_BIT_MASK 0x1ffffffULL
    #define XOF_ELEMENT_COUNT ((ROUNDS + 1) * BLOCKSIZE)

    #define R 0x100000000ULL
    #define R2_MOD_Q 0x3038f3ULL
    #define Qbar_MOD_R 0x1fbffffULL
    #define RINV_MOD_Q 0x3f010ULL

    #define CDF_TABLE_LEN 8
    #define CDF_TABLE CDF_TABLE_80_M
#elif PARAM_ID == PARAM_80_L
    #define BLOCKSIZE 64
    #define OUTPUTSIZE 60
    #define ROUNDS 2
    #define Q 0x1fc0001ULL
    #define Q_BIT_MASK 0x1ffffffULL
    #define XOF_ELEMENT_COUNT ((ROUNDS + 1) * BLOCKSIZE)

    #define R 0x100000000ULL
    #define R2_MOD_Q 0x3038f3ULL
    #define Qbar_MOD_R 0x1fbffffULL
    #define RINV_MOD_Q 0x3f010ULL
#elif PARAM_ID == PARAM_128_S
    #define BLOCKSIZE 16
    #define OUTPUTSIZE 12
    #define ROUNDS 5
    #define Q 0x3ee0001ULL
    #define Q_BIT_MASK 0x3ffffffULL
    #define XOF_ELEMENT_COUNT ((ROUNDS + 1) * BLOCKSIZE)

    #define R 0x100000000ULL
    #define R2_MOD_Q 0x2b2e03bULL
    #define Qbar_MOD_R 0x3edffffULL
    #define RINV_MOD_Q 0xf7144ULL
#elif PARAM_ID == PARAM_128_M
    #define BLOCKSIZE 36
    #define OUTPUTSIZE 32
    #define ROUNDS 3
    #define Q 0x1fc0001ULL
    #define Q_BIT_MASK 0x1ffffffULL
    #define XOF_ELEMENT_COUNT ((ROUNDS + 1) * BLOCKSIZE)

    #define R 0x100000000ULL
    #define R2_MOD_Q 0x3038f3ULL
    #define Qbar_MOD_R 0x1fbffffULL
    #define RINV_MOD_Q 0x3f010ULL

    #define CDF_TABLE_LEN 11
    #define CDF_TABLE CDF_TABLE_128_ML
#elif PARAM_ID == PARAM_128_L
    #define BLOCKSIZE 64
    #define OUTPUTSIZE 60
    #define ROUNDS 2
    #define Q 0x1fc0001ULL
    #define Q_BIT_MASK 0x1ffffffULL
    #define XOF_ELEMENT_COUNT ((ROUNDS + 1) * BLOCKSIZE)

    #define R 0x100000000ULL
    #define R2_MOD_Q 0x3038f3ULL
    #define Qbar_MOD_R 0x1fbffffULL
    #define RINV_MOD_Q 0x3f010ULL

    #define CDF_TABLE_LEN 11
    #define CDF_TABLE CDF_TABLE_128_ML
#endif

#if XOF_TYPE == XOF_SHAKE256
    #define XOF Shake
    #define RATE_IN_BYTE 136
#elif XOF_TYPE == XOF_SHAKE128
    #define XOF Shake
    #define RATE_IN_BYTE 168
#elif XOF_TYPE == XOF_AES
    #define XOF XoAES
    #define RATE_IN_BYTE 128
#endif

#endif
